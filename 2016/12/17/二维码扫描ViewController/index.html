<!doctype html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






  

<link href="//cdn.bootcss.com/font-awesome/4.6.2/css/font-awesome.min.css" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="iOS," />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta name="description" content="æœ€è¿‘åœ¨åšçš„ä¸€ä¸ªé¡¹ç›®é‡Œé¢åŒ…å«äº†æ‰«ç é€»è¾‘ï¼Œå› ä¸ºä¹‹å‰å…¬å¸çš„ä¸€äº›é¡¹ç›®ç”¨çš„æ˜¯æ—§çš„ç¬¬ä¸‰æ–¹æ¡†æ¶ï¼Œå‡†ç¡®æ€§å’Œé€Ÿåº¦éƒ½ä¸åŸç”Ÿå­˜åœ¨ä¸€å®šçš„å·®è·ï¼Œç•Œé¢å¯å˜æ€§å±€é™å¤§ï¼Œç»´æŠ¤æˆæœ¬é«˜ï¼Œä¸èƒ½å¿ğŸ˜¤ï¼Œæ‰€ä»¥è‡ªå·±ç”¨åŸç”ŸAPIé‡å†™äº†ä¸€ä¸ªæ‰«ç æ¨¡å—ï¼ŒGithubå…·ä½“ä»£ç å¯ç‚¹å‡»æ­¤å¤„ã€‚å®˜æ–¹çš„æ‰«ç APIæ˜¯åœ¨iOS8ä¸Šæ¨å‡ºçš„ï¼Œå¦‚ä»Šç³»ç»Ÿè¿­ä»£åˆ°äº†iOS10ï¼ŒiOS8ä»¥ä¸‹ç³»ç»Ÿçš„å¸‚åœºå æœ‰ç‡å·²ç»å¯ä»¥å¿½ç•¥ï¼Œå¹¶ä¸”APPé€‚é…ç°åœ¨ä¹Ÿæ˜¯ä»iOS8å¼€å§‹ã€‚
æœ€ç»ˆçš„å®ç°æ•ˆæœï¼š">
<meta property="og:type" content="article">
<meta property="og:title" content="iOS 8+ åŸç”ŸAPIå®ç°äºŒç»´ç æ‰«æViewController">
<meta property="og:url" content="yuzhenbang.com/2016/12/17/äºŒç»´ç æ‰«æViewController/index.html">
<meta property="og:site_name" content="Cosin.Jubal">
<meta property="og:description" content="æœ€è¿‘åœ¨åšçš„ä¸€ä¸ªé¡¹ç›®é‡Œé¢åŒ…å«äº†æ‰«ç é€»è¾‘ï¼Œå› ä¸ºä¹‹å‰å…¬å¸çš„ä¸€äº›é¡¹ç›®ç”¨çš„æ˜¯æ—§çš„ç¬¬ä¸‰æ–¹æ¡†æ¶ï¼Œå‡†ç¡®æ€§å’Œé€Ÿåº¦éƒ½ä¸åŸç”Ÿå­˜åœ¨ä¸€å®šçš„å·®è·ï¼Œç•Œé¢å¯å˜æ€§å±€é™å¤§ï¼Œç»´æŠ¤æˆæœ¬é«˜ï¼Œä¸èƒ½å¿ğŸ˜¤ï¼Œæ‰€ä»¥è‡ªå·±ç”¨åŸç”ŸAPIé‡å†™äº†ä¸€ä¸ªæ‰«ç æ¨¡å—ï¼ŒGithubå…·ä½“ä»£ç å¯ç‚¹å‡»æ­¤å¤„ã€‚å®˜æ–¹çš„æ‰«ç APIæ˜¯åœ¨iOS8ä¸Šæ¨å‡ºçš„ï¼Œå¦‚ä»Šç³»ç»Ÿè¿­ä»£åˆ°äº†iOS10ï¼ŒiOS8ä»¥ä¸‹ç³»ç»Ÿçš„å¸‚åœºå æœ‰ç‡å·²ç»å¯ä»¥å¿½ç•¥ï¼Œå¹¶ä¸”APPé€‚é…ç°åœ¨ä¹Ÿæ˜¯ä»iOS8å¼€å§‹ã€‚
æœ€ç»ˆçš„å®ç°æ•ˆæœï¼š">
<meta property="og:image" content="http://oic275rsr.bkt.clouddn.com/2016121757403final.jpg">
<meta property="og:image" content="http://oic275rsr.bkt.clouddn.com/2016121728331final4.jpg">
<meta property="og:image" content="http://oic275rsr.bkt.clouddn.com/2016121772985scanDemo.gif">
<meta property="og:image" content="http://oic275rsr.bkt.clouddn.com/201612183772å±å¹•å¿«ç…§ 2016-12-18 00.15.51.png">
<meta property="og:image" content="http://oic275rsr.bkt.clouddn.com/20161218603042016-12-18 at 01.png">
<meta property="og:image" content="http://oic275rsr.bkt.clouddn.com/2016121848035å±å¹•å¿«ç…§ 2016-12-18 01.28.15.png">
<meta property="og:image" content="http://oic275rsr.bkt.clouddn.com/20161218710472016-12-18 at 01.43.png">
<meta property="og:image" content="http://oic275rsr.bkt.clouddn.com/20161218835342016-12-18 at 02.png">
<meta property="og:updated_time" content="2016-12-17T18:26:39.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="iOS 8+ åŸç”ŸAPIå®ç°äºŒç»´ç æ‰«æViewController">
<meta name="twitter:description" content="æœ€è¿‘åœ¨åšçš„ä¸€ä¸ªé¡¹ç›®é‡Œé¢åŒ…å«äº†æ‰«ç é€»è¾‘ï¼Œå› ä¸ºä¹‹å‰å…¬å¸çš„ä¸€äº›é¡¹ç›®ç”¨çš„æ˜¯æ—§çš„ç¬¬ä¸‰æ–¹æ¡†æ¶ï¼Œå‡†ç¡®æ€§å’Œé€Ÿåº¦éƒ½ä¸åŸç”Ÿå­˜åœ¨ä¸€å®šçš„å·®è·ï¼Œç•Œé¢å¯å˜æ€§å±€é™å¤§ï¼Œç»´æŠ¤æˆæœ¬é«˜ï¼Œä¸èƒ½å¿ğŸ˜¤ï¼Œæ‰€ä»¥è‡ªå·±ç”¨åŸç”ŸAPIé‡å†™äº†ä¸€ä¸ªæ‰«ç æ¨¡å—ï¼ŒGithubå…·ä½“ä»£ç å¯ç‚¹å‡»æ­¤å¤„ã€‚å®˜æ–¹çš„æ‰«ç APIæ˜¯åœ¨iOS8ä¸Šæ¨å‡ºçš„ï¼Œå¦‚ä»Šç³»ç»Ÿè¿­ä»£åˆ°äº†iOS10ï¼ŒiOS8ä»¥ä¸‹ç³»ç»Ÿçš„å¸‚åœºå æœ‰ç‡å·²ç»å¯ä»¥å¿½ç•¥ï¼Œå¹¶ä¸”APPé€‚é…ç°åœ¨ä¹Ÿæ˜¯ä»iOS8å¼€å§‹ã€‚
æœ€ç»ˆçš„å®ç°æ•ˆæœï¼š">
<meta name="twitter:image" content="http://oic275rsr.bkt.clouddn.com/2016121757403final.jpg">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post"},
    fancybox: false,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'åšä¸»'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="yuzhenbang.com/2016/12/17/äºŒç»´ç æ‰«æViewController/"/>





  <title> iOS 8+ åŸç”ŸAPIå®ç°äºŒç»´ç æ‰«æViewController | Cosin.Jubal </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  



  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?55509f7a51c6654e31a4a4cd3ac3cabb";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>








  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Cosin.Jubal</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle"></p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            é¦–é¡µ
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            å½’æ¡£
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            æ ‡ç­¾
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="yuzhenbang.com/2016/12/17/äºŒç»´ç æ‰«æViewController/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Jubal">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="http://wenxaun.oss-cn-hangzhou.aliyuncs.com/JubalBlogResources/images/avtar.png">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Cosin.Jubal">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="Cosin.Jubal" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                iOS 8+ åŸç”ŸAPIå®ç°äºŒç»´ç æ‰«æViewController
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-12-17T19:35:15+08:00">
                2016-12-17
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>æœ€è¿‘åœ¨åšçš„ä¸€ä¸ªé¡¹ç›®é‡Œé¢åŒ…å«äº†æ‰«ç é€»è¾‘ï¼Œå› ä¸ºä¹‹å‰å…¬å¸çš„ä¸€äº›é¡¹ç›®ç”¨çš„æ˜¯æ—§çš„ç¬¬ä¸‰æ–¹æ¡†æ¶ï¼Œå‡†ç¡®æ€§å’Œé€Ÿåº¦éƒ½ä¸åŸç”Ÿå­˜åœ¨ä¸€å®šçš„å·®è·ï¼Œç•Œé¢å¯å˜æ€§å±€é™å¤§ï¼Œç»´æŠ¤æˆæœ¬é«˜ï¼Œä¸èƒ½å¿ğŸ˜¤ï¼Œæ‰€ä»¥è‡ªå·±ç”¨åŸç”ŸAPIé‡å†™äº†ä¸€ä¸ªæ‰«ç æ¨¡å—ï¼ŒGithubå…·ä½“ä»£ç å¯<a href="https://github.com/zhenbang/JBScanViewController" target="_blank" rel="external">ç‚¹å‡»æ­¤å¤„</a>ã€‚å®˜æ–¹çš„æ‰«ç APIæ˜¯åœ¨iOS8ä¸Šæ¨å‡ºçš„ï¼Œå¦‚ä»Šç³»ç»Ÿè¿­ä»£åˆ°äº†iOS10ï¼ŒiOS8ä»¥ä¸‹ç³»ç»Ÿçš„å¸‚åœºå æœ‰ç‡å·²ç»å¯ä»¥å¿½ç•¥ï¼Œå¹¶ä¸”APPé€‚é…ç°åœ¨ä¹Ÿæ˜¯ä»iOS8å¼€å§‹ã€‚</p>
<p>æœ€ç»ˆçš„å®ç°æ•ˆæœï¼š<br><img src="http://oic275rsr.bkt.clouddn.com/2016121757403final.jpg" alt="2016121757403final.jpg"><a id="more"></a><br><img src="http://oic275rsr.bkt.clouddn.com/2016121728331final4.jpg" alt="2016121728331final4.jpg"><br>åŠ¨ç”»ï¼š<br><img src="http://oic275rsr.bkt.clouddn.com/2016121772985scanDemo.gif" alt="2016121772985scanDemo.gif"></p>
<h1 id="å®ç°æ–¹æ³•"><a href="#å®ç°æ–¹æ³•" class="headerlink" title="å®ç°æ–¹æ³•"></a>å®ç°æ–¹æ³•</h1><p>è¿™é‡Œä½¿ç”¨ViewControllerè¿›è¡Œå®ç°ï¼Œä¹‹å‰è€ƒè™‘è¿‡ç”¨Viewï¼Œå› ä¸ºç”Ÿå‘½å‘¨æœŸçš„é‚£é‡Œå‘æ¯”è¾ƒå¤šï¼Œä¸ºäº†æ–¹ä¾¿ç®¡ç†ç”Ÿå‘½å‘¨æœŸæ‰€ä»¥é‡‡ç”¨äº†ViewControllerè¿›è¡Œå®ç°ã€‚</p>
<h2 id="å·¥ç¨‹è®¾ç½®"><a href="#å·¥ç¨‹è®¾ç½®" class="headerlink" title="å·¥ç¨‹è®¾ç½®"></a>å·¥ç¨‹è®¾ç½®</h2><p>ä½¿ç”¨JBScanViewControllerï¼Œé¡¹ç›®å·¥ç¨‹info.plistéœ€è¦æ·»åŠ ç›¸æœºã€ç›¸å†Œæƒé™(é€‚é…iOS 10)å’Œå°†ç³»ç»ŸStatusBarçš„ä¼˜å…ˆçº§è°ƒä½ï¼Œå¦åˆ™åœ¨ç›¸å†Œé€‰æ‹©å›¾ç‰‡è¿›è¡Œè£åˆ‡æ—¶ä¼šæœ‰20PXçš„ä¸‹æ²‰ã€‚<br><img src="http://oic275rsr.bkt.clouddn.com/201612183772å±å¹•å¿«ç…§ 2016-12-18 00.15.51.png" alt="201612183772å±å¹•å¿«ç…§ 2016-12-18 00.15.51.png"></p>
<h2 id="åŸç”ŸAPIçš„è°ƒç”¨"><a href="#åŸç”ŸAPIçš„è°ƒç”¨" class="headerlink" title="åŸç”ŸAPIçš„è°ƒç”¨"></a>åŸç”ŸAPIçš„è°ƒç”¨</h2><p>å¤´æ–‡ä»¶éœ€è¦ç”¨åˆ°AVFoundationæ¡†æ¶å’ŒMobileCoreServicesï¼Œç›¸æœºçš„æ“ä½œä¾èµ–AVFoundationï¼ŒMobileCoreServicesåˆ™æ˜¯åœ¨çº¦æŸç›¸å†Œç­›é€‰ç±»å‹æ—¶ä½¿ç”¨ã€‚</p>
<p>ViewControlleréœ€è¦éµå¾ª<code>AVCaptureMetadataOutputObjectsDelegate</code>ã€<code>UINavigationControllerDelegate</code>ã€<code>UIImagePickerControllerDelegate</code>ä¸‰ä¸ªä»£ç†ï¼ŒAVCaptureMetadataOutputObjectsDelegateæ˜¯æ¥å—ç›¸æœºè¾“å…¥æµï¼Œå…¶å®ƒä¸¤ä¸ªåˆ™æ˜¯è°ƒç”¨ç³»ç»Ÿç›¸å†Œã€‚</p>
<p>é¦–å…ˆéœ€è¦å£°æ˜ä¸­é—´Session<br><code>AVCaptureSession * session;      //è¾“å…¥è¾“å‡ºçš„ä¸­é—´æ¡¥æ¢</code><br>è¿›è¡Œåˆå§‹åŒ–æ‘„åƒè®¾å¤‡å’Œæ‰«ç è¡Œä¸º<br><figure class="highlight mm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//è·å–æ‘„åƒè®¾å¤‡</span></div><div class="line"><span class="built_in">AVCaptureDevice</span> * device = [<span class="built_in">AVCaptureDevice</span> defaultDeviceWithMediaType:<span class="built_in">AVMediaTypeVideo</span>];</div><div class="line"><span class="comment">//åˆ›å»ºè¾“å…¥æµ</span></div><div class="line"><span class="built_in">AVCaptureDeviceInput</span> * input = [<span class="built_in">AVCaptureDeviceInput</span> deviceInputWithDevice:device error:<span class="literal">nil</span>];</div><div class="line"><span class="comment">//åˆ›å»ºè¾“å‡ºæµ</span></div><div class="line"><span class="built_in">AVCaptureMetadataOutput</span> * output = [[<span class="built_in">AVCaptureMetadataOutput</span> alloc]init];</div><div class="line"><span class="comment">//è®¾ç½®ä»£ç† åœ¨ä¸»çº¿ç¨‹é‡Œåˆ·æ–°</span></div><div class="line">[output setMetadataObjectsDelegate:<span class="keyword">self</span> queue:dispatch_get_main_queue()];</div><div class="line"><span class="comment">//è®¾ç½®æ‰«ç èŒƒå›´(Y,X,HEIGHT,WIDTH)</span></div><div class="line">output.rectOfInterest=<span class="built_in">CGRectMake</span>(</div><div class="line">                                     ((<span class="number">1</span>-(VIEW_SIZE_WIDTH/VIEW_SIZE_HEIGHT*SCAN_RECT_RATIO))/<span class="number">2</span>)+(SCAN_OFFSET/VIEW_SIZE_HEIGHT),</div><div class="line">                                     (<span class="number">1</span>-SCAN_RECT_RATIO)/<span class="number">2</span>,</div><div class="line">                                     VIEW_SIZE_WIDTH/VIEW_SIZE_HEIGHT*SCAN_RECT_RATIO,</div><div class="line">                                     SCAN_RECT_RATIO</div><div class="line">                                     );</div><div class="line"><span class="comment">//åˆå§‹åŒ–é“¾æ¥å¯¹è±¡</span></div><div class="line">session = [[<span class="built_in">AVCaptureSession</span> alloc]init];</div><div class="line"><span class="comment">//é«˜è´¨é‡é‡‡é›†ç‡</span></div><div class="line">[session setSessionPreset:<span class="built_in">AVCaptureSessionPresetHigh</span>];</div><div class="line">[session addInput:input];</div><div class="line">[session addOutput:output];</div><div class="line"><span class="comment">//è®¾ç½®æ‰«ç æ”¯æŒçš„ç¼–ç æ ¼å¼</span></div><div class="line">output.metadataObjectTypes=@[<span class="built_in">AVMetadataObjectTypeQRCode</span>,<span class="built_in">AVMetadataObjectTypeEAN13Code</span>, <span class="built_in">AVMetadataObjectTypeEAN8Code</span>, <span class="built_in">AVMetadataObjectTypeCode128Code</span>];   </div><div class="line"><span class="built_in">AVCaptureVideoPreviewLayer</span> * layer = [<span class="built_in">AVCaptureVideoPreviewLayer</span> layerWithSession:session];</div><div class="line">layer.videoGravity=<span class="built_in">AVLayerVideoGravityResizeAspectFill</span>;</div><div class="line">layer.frame=<span class="keyword">self</span>.view.layer.bounds;</div><div class="line"><span class="comment">//éšè—å¼•å¯¼ç•Œé¢</span></div><div class="line">[acView stopAnimating];</div><div class="line">label.hidden = <span class="literal">YES</span>;</div><div class="line"><span class="comment">//æ’å…¥ç›¸æœºLayer</span></div><div class="line">[<span class="keyword">self</span>.view.layer insertSublayer:layer atIndex:<span class="number">0</span>];</div><div class="line"><span class="comment">//å¼€å§‹æ•è·</span></div><div class="line">[session startRunning];</div></pre></td></tr></table></figure></p>
<p>æ‰«ç èŒƒå›´è¿™é‡Œè¦è®¡ç®—å¥½ï¼Œç‰¹åˆ«éœ€è¦æ³¨æ„çš„æ˜¯æ­¤å¤„åæ ‡ä¸æ­£å¸¸CGRectä¸åŒï¼Œæ­¤å¤„æ˜¯<code>(Y,X,HEIGHT,WIDTH)</code>å¹¶ä¸”å…¨éƒ¨æŒ‰æ¯”ä¾‹(0-1)è®¾å®šï¼Œè®¾å®šäº†æ‰«ç èŒƒå›´åç³»ç»Ÿåªä¼šåˆ¤æ–­è¯¥èŒƒå›´å†…çš„æ•°æ®ï¼Œè¿™æ ·èƒ½æ˜¾è‘—ä»…æé«˜æ•ˆç‡å’ŒæˆåŠŸç‡ï¼ŒJBScanViewControllerè®¾å®šäº†ä¸€äº›å®å‚æ•°ä»¥çµæ´»æ”¹å˜èŒƒå›´å¤§å°å’Œåç§»é‡å¯æ ¹æ®éœ€æ±‚è¿›è¡Œä¿®æ”¹<br><figure class="highlight mm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#define VIEW_SIZE_HEIGHT  self.view.bounds.size.height  //å½“å‰Viewé«˜åº¦</span></div><div class="line"><span class="meta">#define VIEW_SIZE_WIDTH   self.view.bounds.size.width   //å½“å‰Viewå®½åº¦</span></div><div class="line"><span class="meta">#define SCAN_RECT_RATIO   0.7                           //æ‰«ç åŒºåŸŸä¸å½“å‰Viewå®½çš„æ¯”ä¾‹</span></div><div class="line"><span class="meta">#define SCAN_OFFSET       -40                           //æ‰«ææ¡†åç§»é‡(å¤§äº0å¾€ä¸‹ï¼Œå°äº0å¾€ä¸Š)</span></div><div class="line"><span class="meta">#define SCAN_FRAME_ANIMATION_DURATION  0.2              //æ‰«ææ¡†ç”ŸæˆåŠ¨ç”»æ—¶é•¿</span></div></pre></td></tr></table></figure></p>
<p>æ‰§è¡Œå®ŒstartRunningä¹‹åå°±å¼€å§‹è¿›è¡Œæ‰«æäº†ï¼Œä½†æ˜¯è¿™é‡Œä¼šæ¶‰åŠåˆ°ç”Ÿå‘½å‘¨æœŸçš„ä¸€äº›é—®é¢˜ï¼Œå¦‚æœå°†è¿™ä¸€æ®µä»£ç åœ¨<code>ViewDidLoad</code>æ–¹æ³•é‡Œé¢è¿›è¡Œåˆå§‹åŒ–åˆ™ä¼šæœ‰0.5-1ç§’çš„å»¶æ—¶ï¼Œå› ä¸ºåŠ è½½ç›¸æœºä¼šæ¶ˆè€—å¤§é‡çš„æ—¶é—´ï¼Œæ‰€ä»¥ç•Œé¢ä¼šç­‰åˆ°ç›¸æœºåŠ è½½å®Œä¹‹åæ‰Pushï¼Œä¸ºäº†ä¸äº§ç”Ÿå¡é¡¿æ„Ÿï¼Œè¿™é‡Œåšæ³•æ˜¯å°†åˆå§‹åŒ–æ–¹æ³•æ”¾åˆ°<code>ViewDidAppear</code>æ–¹æ³•ä¸­è¿›è¡Œï¼Œå…ˆå°†é¡µé¢Pushï¼Œå†åˆå§‹åŒ–ç›¸æœºï¼Œè¿™æ ·ä¼šéå¸¸æµç•…ï¼Œä½†æ˜¯å…ˆpushè¿‡æ¥å›æœ‰é»‘å±çš„ç•Œé¢ï¼Œå› ä¸ºç›¸æœºè¿˜åœ¨å¯åŠ¨è¿‡ç¨‹ä¸­ï¼Œæ‰€ä»¥åŠ ä¸Šä¸€å±‚UIå¼•å¯¼ç”¨æˆ·è¿›è¡Œç­‰å¾…ã€‚<br><figure class="highlight mm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//å¯åŠ¨æç¤ºå’ŒloadingèŠèŠ±</span></div><div class="line">acView = [[<span class="built_in">UIActivityIndicatorView</span> alloc] initWithActivityIndicatorStyle:<span class="built_in">UIActivityIndicatorViewStyleWhiteLarge</span>];</div><div class="line">label = [<span class="built_in">UILabel</span> new];</div><div class="line">[acView startAnimating];</div><div class="line">[acView setHidesWhenStopped:<span class="literal">YES</span>];</div><div class="line">label.text = <span class="string">@"ç›¸æœºå¯åŠ¨ä¸­..."</span>;</div><div class="line">label.textColor = [<span class="built_in">UIColor</span> whiteColor];</div><div class="line">[label setTextAlignment:<span class="built_in">NSTextAlignmentCenter</span>];</div><div class="line">[<span class="keyword">self</span>.view addSubview:acView];</div><div class="line">[<span class="keyword">self</span>.view addSubview:label];</div><div class="line">acView.frame = <span class="built_in">CGRectMake</span>((VIEW_SIZE_WIDTH<span class="number">-200</span>)/<span class="number">2</span>,(VIEW_SIZE_HEIGHT<span class="number">-200</span>)/<span class="number">2</span><span class="number">-50</span>, <span class="number">200</span>, <span class="number">200</span>);</div><div class="line">label.frame  = <span class="built_in">CGRectMake</span>((VIEW_SIZE_WIDTH<span class="number">-200</span>)/<span class="number">2</span>,(VIEW_SIZE_HEIGHT<span class="number">-30</span>)/<span class="number">2</span>, <span class="number">200</span>, <span class="number">30</span>);</div></pre></td></tr></table></figure></p>
<p>å¾—åˆ°æ‰«æç»“æœä¹‹åä¼šè°ƒç”¨ä»¥ä¸‹ä¸¤ä¸ªå›è°ƒ<br><figure class="highlight mm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#pragma mark - AVCaptureMetadataOutputObjectsDelegate</span></div><div class="line">-(<span class="keyword">void</span>)captureOutput:(<span class="built_in">AVCaptureOutput</span> *)captureOutput didOutputMetadataObjects:(<span class="built_in">NSArray</span> *)metadataObjects fromConnection:(<span class="built_in">AVCaptureConnection</span> *)connection&#123;</div><div class="line">    <span class="keyword">if</span> (metadataObjects.count&gt;<span class="number">0</span>) &#123;</div><div class="line">        [session stopRunning];</div><div class="line">        <span class="built_in">AVMetadataMachineReadableCodeObject</span> * metadataObject = [metadataObjects objectAtIndex : <span class="number">0</span> ];</div><div class="line">        [<span class="keyword">self</span> scanResultString:metadataObject.stringValue];</div><div class="line">        [<span class="keyword">self</span> scanResult:metadataObject];</div><div class="line">        <span class="comment">//è¾“å‡ºæ‰«æå­—ç¬¦ä¸²</span></div><div class="line">        <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>,metadataObject.stringValue);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="meta">#pragma mark - UIImagePickerControllerDelegate</span></div><div class="line">-(<span class="keyword">void</span>)imagePickerController:(<span class="built_in">UIImagePickerController</span> *)picker didFinishPickingMediaWithInfo:(<span class="built_in">NSDictionary</span>&lt;<span class="built_in">NSString</span> *,<span class="keyword">id</span>&gt; *)info&#123;</div><div class="line">    <span class="comment">//è·å–é€‰ä¸­çš„ç…§ç‰‡</span></div><div class="line">    <span class="built_in">UIImage</span> *image = info[<span class="built_in">UIImagePickerControllerEditedImage</span>];</div><div class="line">    <span class="keyword">if</span> (!image) &#123;image = info[<span class="built_in">UIImagePickerControllerOriginalImage</span>];&#125;</div><div class="line">    <span class="comment">//åˆå§‹åŒ–  å°†ç±»å‹è®¾ç½®ä¸ºäºŒç»´ç </span></div><div class="line">    <span class="built_in">CIDetector</span> *detector = [<span class="built_in">CIDetector</span> detectorOfType:<span class="built_in">CIDetectorTypeQRCode</span> context:<span class="literal">nil</span> options:<span class="literal">nil</span>];</div><div class="line">    [picker dismissViewControllerAnimated:<span class="literal">YES</span> completion:^&#123;</div><div class="line">        <span class="comment">//è®¾ç½®æ•°ç»„ï¼Œæ”¾ç½®è¯†åˆ«å®Œä¹‹åçš„æ•°æ®</span></div><div class="line">        <span class="built_in">NSArray</span> *features = [detector featuresInImage:[<span class="built_in">CIImage</span> imageWithData:<span class="built_in">UIImagePNGRepresentation</span>(image)]];</div><div class="line">        <span class="comment">//åˆ¤æ–­æ˜¯å¦æœ‰æ•°æ®ï¼ˆå³æ˜¯å¦æ˜¯äºŒç»´ç ï¼‰</span></div><div class="line">        <span class="keyword">if</span> (features.count &gt;= <span class="number">1</span>) &#123;</div><div class="line">            <span class="comment">//å–ç¬¬ä¸€ä¸ªå…ƒç´ å°±æ˜¯äºŒç»´ç æ‰€å­˜æ”¾çš„æ–‡æœ¬ä¿¡æ¯</span></div><div class="line">            <span class="built_in">CIQRCodeFeature</span> *feature = features[<span class="number">0</span>];</div><div class="line">            <span class="built_in">NSString</span> *scannedResult = feature.messageString;</div><div class="line">            <span class="comment">//é€šè¿‡å¯¹è¯æ¡†çš„å½¢å¼å‘ˆç°(ä¸´æ—¶)</span></div><div class="line">            [<span class="keyword">self</span> scanResultString:scannedResult];</div><div class="line">            [<span class="keyword">self</span> scanResult:feature];</div><div class="line">        &#125;<span class="keyword">else</span>&#123;</div><div class="line">            [<span class="keyword">self</span> alertControllerMessage:<span class="string">@"æœªæ£€æµ‹åˆ°äºŒç»´ç "</span>];</div><div class="line">        &#125;</div><div class="line">    &#125;];</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>è¿™é‡Œå¾—åˆ°çš„ç»“æœä¼šè¿”å›åˆ°æˆ‘å°è£…çš„ä¸¤ä¸ªæ–¹æ³•ä¸­ï¼Œæ¯å¾—åˆ°ä¸€æ¬¡ç»“æœä¼šåŒæ—¶è°ƒç”¨è¿™ä¸¤ä¸ªæ–¹æ³•ï¼Œå¯åœ¨é‡Œé¢è¿›è¡Œæ•°æ®æ“ä½œ<br><figure class="highlight mm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#pragma mark - ScanResult</span></div><div class="line"><span class="comment">/** æ‰«æè·å–å­—ç¬¦ä¸²è§¦å‘ */</span></div><div class="line">- (<span class="keyword">void</span>)scanResultString:(<span class="built_in">NSString</span>*)result&#123;</div><div class="line">    <span class="comment">//æç¤ºæ‰«æç»“æœ(æ¼”ç¤º)</span></div><div class="line">    [<span class="keyword">self</span> alertControllerMessage:result];</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/** æ‰«æè·å–å¯¹è±¡è§¦å‘ */</span></div><div class="line">- (<span class="keyword">void</span>)scanResult:(<span class="keyword">id</span>)result&#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"&gt;&gt;&gt;%@"</span>,result);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h1 id="UIç•Œé¢ä¸åŠ¨ç”»"><a href="#UIç•Œé¢ä¸åŠ¨ç”»" class="headerlink" title="UIç•Œé¢ä¸åŠ¨ç”»"></a>UIç•Œé¢ä¸åŠ¨ç”»</h1><h2 id="æ‰«ææ¡†è’™ç‰ˆUIå’ŒåŠ¨ç”»"><a href="#æ‰«ææ¡†è’™ç‰ˆUIå’ŒåŠ¨ç”»" class="headerlink" title="æ‰«ææ¡†è’™ç‰ˆUIå’ŒåŠ¨ç”»"></a>æ‰«ææ¡†è’™ç‰ˆUIå’ŒåŠ¨ç”»</h2><p>å› ä¸ºè€ƒè™‘åˆ°å¯é›†æˆæ€§ï¼ŒJBScanViewControllerä½¿ç”¨çº¯ä»£ç è¿›è¡ŒUIæ„å»ºï¼Œä¸»è¦ä½¿ç”¨è´å¡å°”æ›²çº¿åœ¨Layerå±‚è¿›è¡ŒåŠ¨ç”»ã€‚é¦–å…ˆéœ€è¦åœ¨ç›¸æœºå±‚ä¸Šæ–¹è¿›è¡Œä¸€å±‚è’™ç‰ˆå¤„ç†<br><img src="http://oic275rsr.bkt.clouddn.com/20161218603042016-12-18 at 01.png" alt="20161218603042016-12-18 at 01.png"><br><figure class="highlight mm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//æ‰«ææ¡†</span></div><div class="line">    <span class="built_in">UIView</span> *maskView = [[<span class="built_in">UIView</span> alloc] initWithFrame:<span class="keyword">self</span>.view.frame];</div><div class="line">    maskView.backgroundColor = [<span class="built_in">UIColor</span> colorWithRed:<span class="number">0</span> green:<span class="number">0</span> blue:<span class="number">0</span> alpha:<span class="number">0.55</span>];</div><div class="line">    [<span class="keyword">self</span>.view addSubview:maskView];</div><div class="line">    <span class="built_in">UIBezierPath</span> *maskPath = [<span class="built_in">UIBezierPath</span> bezierPathWithRect:<span class="built_in">CGRectMake</span>(<span class="number">0</span>, <span class="number">0</span>, VIEW_SIZE_WIDTH, VIEW_SIZE_HEIGHT)];</div><div class="line">    [maskPath appendPath:[[<span class="built_in">UIBezierPath</span> bezierPathWithRoundedRect:<span class="built_in">CGRectMake</span>(VIEW_SIZE_WIDTH/<span class="number">2</span>,VIEW_SIZE_HEIGHT/<span class="number">2</span>+SCAN_OFFSET,<span class="number">0</span>,<span class="number">0</span>) cornerRadius:<span class="number">1</span>] bezierPathByReversingPath]];</div><div class="line">    <span class="keyword">self</span>.maskLayer = [[<span class="built_in">CAShapeLayer</span> alloc] init];</div><div class="line">    <span class="keyword">self</span>.maskLayer.path = maskPath.CGPath;</div><div class="line">    maskView.layer.mask = <span class="keyword">self</span>.maskLayer;</div></pre></td></tr></table></figure></p>
<p>å°†è’™ç‰ˆé€šè¿‡è´å¡å°”çŸ©å½¢è·¯å¾„é•‚ç©ºï¼Œé€šè¿‡æ§åˆ¶è’™ç‰ˆLayerçš„Maskå±æ€§åŠ ä¸Š<code>CABasicAnimation</code>çš„PathåŠ¨ç”»ä½¿è’™ç‰ˆå‡ºç°ç”ŸæˆåŠ¨ç”»<br><img src="http://oic275rsr.bkt.clouddn.com/2016121848035å±å¹•å¿«ç…§ 2016-12-18 01.28.15.png" alt="2016121848035å±å¹•å¿«ç…§ 2016-12-18 01.28.15.png"><br><figure class="highlight mm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/** åŠ è½½æ‰«ææ¡†ç”ŸæˆåŠ¨ç”» */</span></div><div class="line">- (<span class="keyword">void</span>)loadScanAnimation&#123;</div><div class="line">    <span class="built_in">UIBezierPath</span> *maskFinalPath = [<span class="built_in">UIBezierPath</span> bezierPathWithRect:<span class="built_in">CGRectMake</span>(<span class="number">0</span>, <span class="number">0</span>, VIEW_SIZE_WIDTH, VIEW_SIZE_HEIGHT)];</div><div class="line">    [maskFinalPath appendPath:[[<span class="built_in">UIBezierPath</span> bezierPathWithRoundedRect:<span class="built_in">CGRectMake</span>(</div><div class="line">                                                                                  (VIEW_SIZE_WIDTH-VIEW_SIZE_WIDTH*SCAN_RECT_RATIO)/<span class="number">2</span>,</div><div class="line">                                                                                  (VIEW_SIZE_HEIGHT-VIEW_SIZE_WIDTH*SCAN_RECT_RATIO)/<span class="number">2</span>+SCAN_OFFSET,</div><div class="line">                                                                                  VIEW_SIZE_WIDTH*SCAN_RECT_RATIO,</div><div class="line">                                                                                  VIEW_SIZE_WIDTH*SCAN_RECT_RATIO</div><div class="line">                                                                                  ) cornerRadius:<span class="number">1</span>] bezierPathByReversingPath]];</div><div class="line">    <span class="built_in">CABasicAnimation</span> *scanAnimation = [<span class="built_in">CABasicAnimation</span> animationWithKeyPath:<span class="string">@"path"</span>];</div><div class="line">    scanAnimation.toValue = (<span class="keyword">id</span>)maskFinalPath.CGPath;</div><div class="line">    scanAnimation.duration = SCAN_FRAME_ANIMATION_DURATION;</div><div class="line">    scanAnimation.fillMode = kCAFillModeForwards;</div><div class="line">    scanAnimation.removedOnCompletion = <span class="literal">NO</span>;</div><div class="line">    [<span class="keyword">self</span>.maskLayer addAnimation:scanAnimation forKey:<span class="literal">nil</span>];</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="æ‰«ææ¡†å››è§’UIå’ŒåŠ¨ç”»"><a href="#æ‰«ææ¡†å››è§’UIå’ŒåŠ¨ç”»" class="headerlink" title="æ‰«ææ¡†å››è§’UIå’ŒåŠ¨ç”»"></a>æ‰«ææ¡†å››è§’UIå’ŒåŠ¨ç”»</h2><p>è¿™æ—¶è’™ç‰ˆç”Ÿæˆçš„åŠ¨ç”»å·²ç»å®Œæˆï¼Œæˆ‘ä»¬éœ€è¦çš„è¿˜æœ‰è¾¹æ¡†ä¸æ‰«æçº¿çš„UIå’ŒåŠ¨ç”»ï¼Œå°†æ‰«ææ¡†æ‹†åˆ†ä¸ºå››ä¸ªè§’è¿›è¡Œç»˜åˆ¶ï¼Œæ¯ä¸ªè§’çš„ç»˜åˆ¶æ–¹å‘æŒ‰é¡ºæ—¶é’ˆç»˜åˆ¶ï¼Œå¹¶ä¸”X=Y=è¾¹æ¡†è¾¹é•¿ä¹˜ä»¥è¾¹é•¿ä¸Xçš„æ¯”ä¾‹ï¼Œæ‰€ä»¥å½“æˆ‘ä»¬æ›´æ”¹æ¯”ä¾‹è‡³0.5æ—¶å°±èƒ½å®ç°å…¨è¾¹æ¡†åŒ…è£¹ã€‚<br><img src="http://oic275rsr.bkt.clouddn.com/20161218710472016-12-18 at 01.43.png" alt="20161218710472016-12-18 at 01.43.png"><br>æ‰«ææ¡†åˆå§‹å€¼ï¼ˆåŸç‚¹å€¼ï¼‰<br><figure class="highlight mm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//æ‰«ææ¡†</span></div><div class="line">    <span class="built_in">UIView</span> *maskView = [[<span class="built_in">UIView</span> alloc] initWithFrame:<span class="keyword">self</span>.view.frame];</div><div class="line">    maskView.backgroundColor = [<span class="built_in">UIColor</span> colorWithRed:<span class="number">0</span> green:<span class="number">0</span> blue:<span class="number">0</span> alpha:<span class="number">0.55</span>];</div><div class="line">    [<span class="keyword">self</span>.view addSubview:maskView];</div><div class="line">    <span class="built_in">UIBezierPath</span> *maskPath = [<span class="built_in">UIBezierPath</span> bezierPathWithRect:<span class="built_in">CGRectMake</span>(<span class="number">0</span>, <span class="number">0</span>, VIEW_SIZE_WIDTH, VIEW_SIZE_HEIGHT)];</div><div class="line">    [maskPath appendPath:[[<span class="built_in">UIBezierPath</span> bezierPathWithRoundedRect:<span class="built_in">CGRectMake</span>(VIEW_SIZE_WIDTH/<span class="number">2</span>,VIEW_SIZE_HEIGHT/<span class="number">2</span>+SCAN_OFFSET,<span class="number">0</span>,<span class="number">0</span>) cornerRadius:<span class="number">1</span>] bezierPathByReversingPath]];</div><div class="line">    <span class="keyword">self</span>.maskLayer = [[<span class="built_in">CAShapeLayer</span> alloc] init];</div><div class="line">    <span class="keyword">self</span>.maskLayer.path = maskPath.CGPath;</div><div class="line">    maskView.layer.mask = <span class="keyword">self</span>.maskLayer;</div></pre></td></tr></table></figure></p>
<p>æ‰«ææ¡†ç›®æ ‡å€¼<br><figure class="highlight mm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> ç”Ÿæˆæ‰«ææ¡†å››ä¸ªæ‹è§’</div><div class="line"></div><div class="line"> @param color æ‹è§’é¢œè‰²</div><div class="line"> @param lineWidth æ‹è§’çº¿å®½</div><div class="line"> @param ratio çº¿å®½ä¸å½“å‰æ‰«ææ¡†å®½åº¦çš„æ¯”ä¾‹</div><div class="line"> @return å››è§’Layer</div><div class="line"> */</div><div class="line">- (<span class="built_in">CAShapeLayer</span>*)getFourCornerLayerColor:(<span class="built_in">UIColor</span>*)color lineWidth:(<span class="keyword">float</span>)lineWidth lineLenghRatio:(<span class="keyword">float</span>)ratio&#123;</div><div class="line">    <span class="comment">//å››è§’</span></div><div class="line">    <span class="built_in">CAShapeLayer</span> *scanBoxLayer = [[<span class="built_in">CAShapeLayer</span> alloc] init];</div><div class="line">    <span class="built_in">UIBezierPath</span> *fourCorner = [<span class="built_in">UIBezierPath</span> bezierPath];</div><div class="line">    </div><div class="line">    <span class="comment">/** å››ä¸ªè§’çš„è½¨è¿¹ç‚¹å…¨éƒ¨æŒ‰è¯¥è§’é¡ºæ—¶é’ˆæ–¹å‘ç”Ÿæˆ */</span></div><div class="line">    <span class="comment">//å·¦ä¸Šè§’</span></div><div class="line">    <span class="built_in">UIBezierPath</span> *leftUpCorner= [<span class="built_in">UIBezierPath</span> bezierPath];</div><div class="line">    [leftUpCorner moveToPoint:<span class="built_in">CGPointMake</span>(VIEW_SIZE_WIDTH*(<span class="number">1</span>-SCAN_RECT_RATIO)/<span class="number">2</span>, (VIEW_SIZE_HEIGHT-VIEW_SIZE_WIDTH*SCAN_RECT_RATIO)/<span class="number">2</span>+SCAN_OFFSET+VIEW_SIZE_WIDTH*SCAN_RECT_RATIO*ratio)];</div><div class="line">    [leftUpCorner addLineToPoint:<span class="built_in">CGPointMake</span>(VIEW_SIZE_WIDTH*(<span class="number">1</span>-SCAN_RECT_RATIO)/<span class="number">2</span>, (VIEW_SIZE_HEIGHT-VIEW_SIZE_WIDTH*SCAN_RECT_RATIO)/<span class="number">2</span>+SCAN_OFFSET)];</div><div class="line">    [leftUpCorner addLineToPoint:<span class="built_in">CGPointMake</span>(VIEW_SIZE_WIDTH*((<span class="number">1</span>-SCAN_RECT_RATIO)/<span class="number">2</span>+SCAN_RECT_RATIO*ratio), (VIEW_SIZE_HEIGHT-VIEW_SIZE_WIDTH*SCAN_RECT_RATIO)/<span class="number">2</span>+SCAN_OFFSET)];</div><div class="line">    <span class="comment">//å·¦ä¸‹è§’</span></div><div class="line">    <span class="built_in">UIBezierPath</span> *leftDownCorner= [<span class="built_in">UIBezierPath</span> bezierPath];</div><div class="line">    [leftDownCorner moveToPoint:<span class="built_in">CGPointMake</span>(VIEW_SIZE_WIDTH*(<span class="number">1</span>-SCAN_RECT_RATIO)/<span class="number">2</span>+VIEW_SIZE_WIDTH*SCAN_RECT_RATIO*ratio, (VIEW_SIZE_HEIGHT-VIEW_SIZE_WIDTH*SCAN_RECT_RATIO)/<span class="number">2</span>+VIEW_SIZE_WIDTH*SCAN_RECT_RATIO+SCAN_OFFSET)];</div><div class="line">    [leftDownCorner addLineToPoint:<span class="built_in">CGPointMake</span>(VIEW_SIZE_WIDTH*(<span class="number">1</span>-SCAN_RECT_RATIO)/<span class="number">2</span>, (VIEW_SIZE_HEIGHT-VIEW_SIZE_WIDTH*SCAN_RECT_RATIO)/<span class="number">2</span>+VIEW_SIZE_WIDTH*SCAN_RECT_RATIO+SCAN_OFFSET)];</div><div class="line">    [leftDownCorner addLineToPoint:<span class="built_in">CGPointMake</span>(VIEW_SIZE_WIDTH*(<span class="number">1</span>-SCAN_RECT_RATIO)/<span class="number">2</span>, VIEW_SIZE_HEIGHT/<span class="number">2</span>-VIEW_SIZE_WIDTH*SCAN_RECT_RATIO*(ratio<span class="number">-0.5</span>)+SCAN_OFFSET)];</div><div class="line">    <span class="comment">//å³ä¸Šè§’</span></div><div class="line">    <span class="built_in">UIBezierPath</span> *rightUpCorner= [<span class="built_in">UIBezierPath</span> bezierPath];</div><div class="line">    [rightUpCorner moveToPoint:<span class="built_in">CGPointMake</span>(VIEW_SIZE_WIDTH*(<span class="number">1</span>-(<span class="number">1</span>-SCAN_RECT_RATIO)/<span class="number">2</span>)-VIEW_SIZE_WIDTH*SCAN_RECT_RATIO*ratio, (VIEW_SIZE_HEIGHT-VIEW_SIZE_WIDTH*SCAN_RECT_RATIO)/<span class="number">2</span>+SCAN_OFFSET)];</div><div class="line">    [rightUpCorner addLineToPoint:<span class="built_in">CGPointMake</span>(VIEW_SIZE_WIDTH*(<span class="number">1</span>-(<span class="number">1</span>-SCAN_RECT_RATIO)/<span class="number">2</span>), (VIEW_SIZE_HEIGHT-VIEW_SIZE_WIDTH*SCAN_RECT_RATIO)/<span class="number">2</span>+SCAN_OFFSET)];</div><div class="line">    [rightUpCorner addLineToPoint:<span class="built_in">CGPointMake</span>(VIEW_SIZE_WIDTH*(<span class="number">1</span>-(<span class="number">1</span>-SCAN_RECT_RATIO)/<span class="number">2</span>), VIEW_SIZE_HEIGHT/<span class="number">2</span>-VIEW_SIZE_WIDTH*SCAN_RECT_RATIO*(<span class="number">0.5</span>-ratio)+SCAN_OFFSET)];</div><div class="line">    <span class="comment">//å³ä¸‹è§’</span></div><div class="line">    <span class="built_in">UIBezierPath</span> *rightDownCorner= [<span class="built_in">UIBezierPath</span> bezierPath];</div><div class="line">    [rightDownCorner moveToPoint:<span class="built_in">CGPointMake</span>(VIEW_SIZE_WIDTH*(<span class="number">1</span>-(<span class="number">1</span>-SCAN_RECT_RATIO)/<span class="number">2</span>), (VIEW_SIZE_HEIGHT-VIEW_SIZE_WIDTH*SCAN_RECT_RATIO)/<span class="number">2</span>+SCAN_OFFSET-VIEW_SIZE_WIDTH*SCAN_RECT_RATIO*ratio+VIEW_SIZE_WIDTH*SCAN_RECT_RATIO)];</div><div class="line">    [rightDownCorner addLineToPoint:<span class="built_in">CGPointMake</span>(VIEW_SIZE_WIDTH*(<span class="number">1</span>-(<span class="number">1</span>-SCAN_RECT_RATIO)/<span class="number">2</span>), (VIEW_SIZE_HEIGHT-VIEW_SIZE_WIDTH*SCAN_RECT_RATIO)/<span class="number">2</span>+VIEW_SIZE_WIDTH*SCAN_RECT_RATIO+SCAN_OFFSET)];</div><div class="line">    [rightDownCorner addLineToPoint:<span class="built_in">CGPointMake</span>(VIEW_SIZE_WIDTH*(<span class="number">1</span>-(<span class="number">1</span>-SCAN_RECT_RATIO)/<span class="number">2</span>)-VIEW_SIZE_WIDTH*SCAN_RECT_RATIO*ratio,  (VIEW_SIZE_HEIGHT-VIEW_SIZE_WIDTH*SCAN_RECT_RATIO)/<span class="number">2</span>+VIEW_SIZE_WIDTH*SCAN_RECT_RATIO+SCAN_OFFSET)];</div><div class="line">    <span class="comment">//æ·»åŠ æ‰€æœ‰è·¯å¾„</span></div><div class="line">    [fourCorner appendPath:leftUpCorner];</div><div class="line">    [fourCorner appendPath:leftDownCorner];</div><div class="line">    [fourCorner appendPath:rightUpCorner];</div><div class="line">    [fourCorner appendPath:rightDownCorner];</div><div class="line">    <span class="comment">//è®¾ç½®çº¿å®½å’Œé¢œè‰²</span></div><div class="line">    scanBoxLayer.lineWidth = lineWidth;</div><div class="line">    scanBoxLayer.strokeColor = color.CGColor;</div><div class="line">    scanBoxLayer.fillColor = <span class="literal">nil</span>;</div><div class="line">    <span class="comment">//æ·»åŠ åŠ¨ç”»</span></div><div class="line">    <span class="built_in">UIBezierPath</span> *initPath = [<span class="built_in">UIBezierPath</span> bezierPathWithRect:<span class="built_in">CGRectMake</span>(VIEW_SIZE_WIDTH/<span class="number">2</span>, VIEW_SIZE_HEIGHT/<span class="number">2</span>+SCAN_OFFSET, <span class="number">0</span>, <span class="number">0</span>)];</div><div class="line">    scanBoxLayer.path = initPath.CGPath;</div><div class="line">    <span class="built_in">CABasicAnimation</span> *cornerAnimation = [<span class="built_in">CABasicAnimation</span> animationWithKeyPath:<span class="string">@"path"</span>];</div><div class="line">    cornerAnimation.toValue = (<span class="keyword">id</span>)fourCorner.CGPath;</div><div class="line">    cornerAnimation.duration = SCAN_FRAME_ANIMATION_DURATION;</div><div class="line">    cornerAnimation.fillMode = kCAFillModeForwards;</div><div class="line">    cornerAnimation.removedOnCompletion = <span class="literal">NO</span>;</div><div class="line">    [scanBoxLayer addAnimation:cornerAnimation forKey:<span class="literal">nil</span>];</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> scanBoxLayer;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="æ‰«æçº¿UIå’ŒåŠ¨ç”»"><a href="#æ‰«æçº¿UIå’ŒåŠ¨ç”»" class="headerlink" title="æ‰«æçº¿UIå’ŒåŠ¨ç”»"></a>æ‰«æçº¿UIå’ŒåŠ¨ç”»</h2><p>æœ€ååŠ ä¸Šæ‰«æçº¿çš„UIå’ŒåŠ¨ç”»å°±èƒ½å®Œæˆäº†ï¼Œæ‰«æçº¿éœ€è¦ç”¨åˆ°ä¸€ä¸ªçŸ©å½¢Layerå±‚åŠ ä¸Šæ¸å˜è‰²ï¼Œç„¶åå°†å…¶Maskå±æ€§æ·»åŠ æ¤­åœ†Pathé®ç½©ï¼Œæœ€åç”Ÿæˆæ‰«æçº¿è¾¹ç¼˜åŠé€æ˜çš„æ•ˆæœï¼Œå› ä¸ºæ¸å˜å±‚Frameå±æ€§ä¸èƒ½æ·»åŠ åŠ¨ç”»ï¼Œæ‰€ä»¥å°†åŠ¨ç”»æ·»åŠ åˆ°Positionå±æ€§ï¼Œé€šè¿‡æ”¹å˜èµ·å§‹ç‚¹å’Œç»ˆæ­¢ç‚¹æ¥å®Œæˆä»æ— åˆ°æœ‰çš„åŠ¨ç”»ã€‚æ‰«æåŠ¨ç”»åŒç†æ”¹å˜å…¶Positionçš„é«˜åº¦å€¼ï¼Œä½†æ˜¯è¦ç‰¹åˆ«æ³¨æ„<code>removedOnCompletion</code>å±æ€§ï¼Œå¦åˆ™æŒ‰homeé”®é€€å‡ºæ—¶ä¼šåœæ­¢æ‰«æåŠ¨ç”»ã€‚<br><img src="http://oic275rsr.bkt.clouddn.com/20161218835342016-12-18 at 02.png" alt="20161218835342016-12-18 at 02.png"><br><figure class="highlight mm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> ç”Ÿæˆæ‰«æçº¿</div><div class="line"></div><div class="line"> @param color æ‰«æçº¿é¢œè‰²</div><div class="line"> @param height æ‰«æçº¿åšåº¦</div><div class="line"> @param duration æ‰«æçº¿åŠ¨ç”»æ—¶é—´</div><div class="line"> @return æ‰«æçº¿Layer</div><div class="line"> */</div><div class="line">- (<span class="built_in">CAGradientLayer</span>*)getScanLine:(<span class="built_in">UIColor</span>*)color height:(<span class="keyword">float</span>)height duration:(<span class="keyword">float</span>)duration&#123;</div><div class="line">    <span class="comment">//æ‰«æçº¿ç”Ÿæˆå’Œé®ç½©</span></div><div class="line">    <span class="built_in">CAShapeLayer</span> *scanlineMask = [[<span class="built_in">CAShapeLayer</span> alloc] init];</div><div class="line">    <span class="built_in">UIBezierPath</span> *scanLineMaskPath = [<span class="built_in">UIBezierPath</span>  bezierPathWithOvalInRect:<span class="built_in">CGRectMake</span>(<span class="number">0</span>, <span class="number">0</span>, VIEW_SIZE_WIDTH*SCAN_RECT_RATIO*<span class="number">0.95</span>, height)];</div><div class="line">    scanlineMask.path = scanLineMaskPath.CGPath;</div><div class="line">    scanlineMask.strokeColor = color.CGColor;</div><div class="line">    scanlineMask.fillColor = color.CGColor;</div><div class="line">    <span class="built_in">CAGradientLayer</span> *scanLineLayer = [<span class="built_in">CAGradientLayer</span> layer];</div><div class="line">    scanLineLayer.frame    = <span class="built_in">CGRectMake</span>(<span class="number">0</span>, <span class="number">0</span>, VIEW_SIZE_WIDTH*SCAN_RECT_RATIO*<span class="number">0.95</span>, height);</div><div class="line">    scanLineLayer.position = <span class="built_in">CGPointMake</span>(VIEW_SIZE_WIDTH/<span class="number">2</span>, VIEW_SIZE_HEIGHT/<span class="number">2</span>+SCAN_OFFSET);</div><div class="line">    scanLineLayer.colors = @[(__bridge <span class="keyword">id</span>)[color colorWithAlphaComponent:<span class="number">0.05</span>].CGColor,</div><div class="line">                          (__bridge <span class="keyword">id</span>)[color colorWithAlphaComponent:<span class="number">0.8</span>].CGColor,</div><div class="line">                          (__bridge <span class="keyword">id</span>)[color colorWithAlphaComponent:<span class="number">0.05</span>].CGColor];</div><div class="line">    scanLineLayer.locations  = @[@(<span class="number">0.05</span>), @(<span class="number">0.5</span>), @(<span class="number">0.95</span>)];</div><div class="line">    scanLineLayer.startPoint = <span class="built_in">CGPointMake</span>(<span class="number">0.5</span>, <span class="number">0.5</span>);</div><div class="line">    scanLineLayer.endPoint   = <span class="built_in">CGPointMake</span>(<span class="number">0.5</span>, <span class="number">0.5</span>);</div><div class="line">    scanLineLayer.mask = scanlineMask;</div><div class="line">    <span class="comment">//æ‰«æçº¿ç”ŸæˆåŠ¨ç”»</span></div><div class="line">    <span class="built_in">CABasicAnimation</span> *scanLinePositionAnimation = [<span class="built_in">CABasicAnimation</span> animationWithKeyPath:<span class="string">@"position"</span>];</div><div class="line">    scanLinePositionAnimation.toValue = [<span class="built_in">NSValue</span> valueWithCGPoint:<span class="built_in">CGPointMake</span>(VIEW_SIZE_WIDTH/<span class="number">2</span>, (VIEW_SIZE_HEIGHT-VIEW_SIZE_WIDTH*SCAN_RECT_RATIO)/<span class="number">2</span>+SCAN_OFFSET+height)];</div><div class="line">    <span class="built_in">CABasicAnimation</span> *scanLineStartPointAnimation = [<span class="built_in">CABasicAnimation</span> animationWithKeyPath:<span class="string">@"startPoint"</span>];</div><div class="line">    scanLineStartPointAnimation.toValue = [<span class="built_in">NSValue</span> valueWithCGPoint:<span class="built_in">CGPointMake</span>(<span class="number">0</span>, <span class="number">0</span>)];</div><div class="line">    <span class="built_in">CABasicAnimation</span> *scanLineEndPointAnimation = [<span class="built_in">CABasicAnimation</span> animationWithKeyPath:<span class="string">@"endPoint"</span>];</div><div class="line">    scanLineEndPointAnimation.toValue = [<span class="built_in">NSValue</span> valueWithCGPoint:<span class="built_in">CGPointMake</span>(<span class="number">1</span>, <span class="number">0</span>)];</div><div class="line">    <span class="built_in">CAAnimationGroup</span> *initialAnimations = [<span class="built_in">CAAnimationGroup</span> animation];</div><div class="line">    initialAnimations.animations = @[scanLinePositionAnimation,scanLineStartPointAnimation,scanLineEndPointAnimation];</div><div class="line">    initialAnimations.duration=SCAN_FRAME_ANIMATION_DURATION;</div><div class="line">    initialAnimations.removedOnCompletion = <span class="literal">NO</span>;</div><div class="line">    initialAnimations.fillMode = kCAFillModeForwards;</div><div class="line">    [scanLineLayer addAnimation:initialAnimations forKey:<span class="literal">nil</span>];</div><div class="line">    <span class="comment">//æ‰«æåŠ¨ç”»</span></div><div class="line">    <span class="built_in">CABasicAnimation</span> *scanAnimation = [<span class="built_in">CABasicAnimation</span> animationWithKeyPath:<span class="string">@"position"</span>];</div><div class="line">    scanAnimation.toValue = [<span class="built_in">NSValue</span> valueWithCGPoint:<span class="built_in">CGPointMake</span>(VIEW_SIZE_WIDTH/<span class="number">2</span>, (VIEW_SIZE_HEIGHT-VIEW_SIZE_WIDTH*SCAN_RECT_RATIO)/<span class="number">2</span>+SCAN_OFFSET-height+VIEW_SIZE_WIDTH*SCAN_RECT_RATIO)];</div><div class="line">    scanAnimation.duration = duration;</div><div class="line">    scanAnimation.repeatCount = HUGE_VALF;</div><div class="line">    scanAnimation.removedOnCompletion = <span class="literal">NO</span>;</div><div class="line">    [scanLineLayer addAnimation:scanAnimation forKey:<span class="literal">nil</span>];</div><div class="line">    <span class="keyword">return</span> scanLineLayer;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h1 id="å…¶å®ƒæ–¹æ³•"><a href="#å…¶å®ƒæ–¹æ³•" class="headerlink" title="å…¶å®ƒæ–¹æ³•"></a>å…¶å®ƒæ–¹æ³•</h1><p>æä¾›äº†ç›¸å†Œè¯»å–æ–¹æ³•å’Œé—ªå…‰ç¯å¼€å¯/å…³é—­æ–¹æ³•ï¼Œå¯è‡ªè¡Œè°ƒç”¨<br><figure class="highlight mm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#pragma mark - CommonMethod</span></div><div class="line"><span class="comment">/** ç›¸å†Œè¯»å–å›¾ç‰‡æ–¹æ³• */</span></div><div class="line">- (<span class="keyword">void</span>)scanImage&#123;</div><div class="line">    <span class="built_in">UIImagePickerController</span> *imagrPicker = [[<span class="built_in">UIImagePickerController</span> alloc]init];</div><div class="line">    imagrPicker.delegate = <span class="keyword">self</span>;</div><div class="line">    imagrPicker.allowsEditing = <span class="literal">YES</span>;</div><div class="line">    imagrPicker.mediaTypes = [[<span class="built_in">NSArray</span> alloc] initWithObjects:(<span class="built_in">NSString</span>*)kUTTypeImage,<span class="literal">nil</span>];</div><div class="line">    <span class="comment">//å°†æ¥æºè®¾ç½®ä¸ºç›¸å†Œ</span></div><div class="line">    imagrPicker.sourceType = <span class="built_in">UIImagePickerControllerSourceTypePhotoLibrary</span>;</div><div class="line">    [<span class="keyword">self</span> presentViewController:imagrPicker animated:<span class="literal">YES</span> completion:<span class="literal">nil</span>];</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/** é—ªå…‰ç¯å¼€å…³æ–¹æ³• */</span></div><div class="line">- (<span class="keyword">void</span>)onOffFlashLight:(<span class="built_in">BOOL</span>)on&#123;</div><div class="line">    <span class="built_in">AVCaptureDevice</span> *device = [<span class="built_in">AVCaptureDevice</span> defaultDeviceWithMediaType:<span class="built_in">AVMediaTypeVideo</span>];</div><div class="line">    <span class="keyword">if</span> ([device hasTorch]) &#123;</div><div class="line">        </div><div class="line">        [device lockForConfiguration:<span class="literal">nil</span>];</div><div class="line">        <span class="keyword">if</span> (on) &#123;</div><div class="line">            [device setTorchMode:<span class="built_in">AVCaptureTorchModeOn</span>];</div><div class="line">        &#125;<span class="keyword">else</span>&#123;</div><div class="line">            [device setTorchMode:<span class="built_in">AVCaptureTorchModeOff</span>];</div><div class="line">        &#125;</div><div class="line">        [device unlockForConfiguration];</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>JBScanViewControllerå¤§éƒ¨åˆ†ä»£ç å®ç°çš„åŠŸèƒ½æ˜¯UIå’ŒåŠ¨ç”»ï¼Œå¯¹æ•´ä½“çš„æ—¶é•¿å’Œç¾è§‚åº¦è¿›è¡Œäº†è€ƒé‡ï¼ŒåŒæ—¶å…¼é¡¾æ€§èƒ½å’Œç•Œé¢æµç•…åº¦ï¼Œä¹ŸæŠ½ç¦»å‡ºå¸¸ç”¨å±æ€§ä»¥é€‚åº”ä¸åŒçš„é¡¹ç›®éœ€æ±‚ã€‚å…·ä½“ä½¿ç”¨å¯ä¸‹è½½<a href="https://github.com/zhenbang/JBScanViewController" target="_blank" rel="external">Demo</a>è¿›è¡Œäº†è§£ã€‚</p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>


    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/iOS/" rel="tag"># iOS</a>
          
        </div>
      

      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            æ–‡ç« ç›®å½•
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            ç«™ç‚¹æ¦‚è§ˆ
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="http://wenxaun.oss-cn-hangzhou.aliyuncs.com/JubalBlogResources/images/avtar.png"
               alt="Jubal" />
          <p class="site-author-name" itemprop="name">Jubal</p>
          <p class="site-description motion-element" itemprop="description">ä»€ä¹ˆéƒ½ä¼šä¸€ç‚¹å„¿â˜ºï¸</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">1</span>
              <span class="site-state-item-name">æ—¥å¿—</span>
            </a>
          </div>

          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">1</span>
                <span class="site-state-item-name">æ ‡ç­¾</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/zhenbang" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/youridiot" target="_blank" title="å¾®åš">
                  
                    <i class="fa fa-fw fa-weibo"></i>
                  
                  å¾®åš
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#å®ç°æ–¹æ³•"><span class="nav-number">1.</span> <span class="nav-text">å®ç°æ–¹æ³•</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#å·¥ç¨‹è®¾ç½®"><span class="nav-number">1.1.</span> <span class="nav-text">å·¥ç¨‹è®¾ç½®</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#åŸç”ŸAPIçš„è°ƒç”¨"><span class="nav-number">1.2.</span> <span class="nav-text">åŸç”ŸAPIçš„è°ƒç”¨</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#UIç•Œé¢ä¸åŠ¨ç”»"><span class="nav-number">2.</span> <span class="nav-text">UIç•Œé¢ä¸åŠ¨ç”»</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#æ‰«ææ¡†è’™ç‰ˆUIå’ŒåŠ¨ç”»"><span class="nav-number">2.1.</span> <span class="nav-text">æ‰«ææ¡†è’™ç‰ˆUIå’ŒåŠ¨ç”»</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#æ‰«ææ¡†å››è§’UIå’ŒåŠ¨ç”»"><span class="nav-number">2.2.</span> <span class="nav-text">æ‰«ææ¡†å››è§’UIå’ŒåŠ¨ç”»</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#æ‰«æçº¿UIå’ŒåŠ¨ç”»"><span class="nav-number">2.3.</span> <span class="nav-text">æ‰«æçº¿UIå’ŒåŠ¨ç”»</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#å…¶å®ƒæ–¹æ³•"><span class="nav-number">3.</span> <span class="nav-text">å…¶å®ƒæ–¹æ³•</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Jubal</span>
</div>



        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>











  
  <script type="text/javascript" src="//cdn.jsdelivr.net/jquery/2.1.3/jquery.min.js"></script>

  
  <script type="text/javascript" src="//cdn.jsdelivr.net/fastclick/1.0.6/fastclick.min.js"></script>

  
  <script type="text/javascript" src="//cdn.jsdelivr.net/jquery.lazyload/1.9.3/jquery.lazyload.min.js"></script>

  
  <script type="text/javascript" src="//jubalblog.oss-cn-shenzhen.aliyuncs.com/velocity/1.2.1/velocity.min.js"></script>

  
  <script type="text/javascript" src="//jubalblog.oss-cn-shenzhen.aliyuncs.com/velocity/1.2.1/velocity.ui.js"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  



  




	




  
  

  

  

  

  


</body>
</html>
